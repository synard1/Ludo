<x-default-layout>
    <div class="card">
        <!--begin::Card body-->
        <div class="card-body fs-6 py-15 px-10 py-lg-15 px-lg-15 text-gray-700">
            <div class="py-5">
                <div class="rounded border p-10">
                    <ul class="nav nav-tabs nav-line-tabs mb-5 fs-6" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" data-bs-toggle="tab" href="#kt_tab_pane_7" aria-selected="true"
                                role="tab">Company Profile</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_8" aria-selected="false"
                                tabindex="-1" role="tab">Link 2</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" data-bs-toggle="tab" href="#kt_tab_pane_9" aria-selected="false"
                                tabindex="-1" role="tab">Link 3</a>
                        </li>
                        <li class="nav-item dropdown" role="presentation">
                            <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button"
                                aria-expanded="false">Dropdown</a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" data-bs-toggle="tab" href="#kt_tab_pane_10"
                                        aria-selected="false" tabindex="-1" role="tab">Action</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="tab" href="#kt_tab_pane_11"
                                        aria-selected="false" tabindex="-1" role="tab">Another action</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="tab" href="#kt_tab_pane_12"
                                        aria-selected="false" tabindex="-1" role="tab">Something else here</a></li>
                                <li><a class="dropdown-item" data-bs-toggle="tab" href="#kt_tab_pane_13"
                                        aria-selected="false" tabindex="-1" role="tab">Separated link</a></li>
                            </ul>
                        </li>
                    </ul>

                    <div class="tab-content" id="myTabContent">
                        <div class="tab-pane fade show active" id="kt_tab_pane_7" role="tabpanel">
                            <table id="companyTable" class="display responsive nowrap" style="width:100%">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>CID</th>
                                        <th>User ID</th>
                                        <th>Name</th>
                                        <th>Status</th>
                                        <th>Address</th>
                                        <th>Phone</th>
                                        <th>Email</th>
                                        <th>Website</th>
                                        <th>Logo</th>
                                        <th>Created At</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_8" role="tabpanel">
                            Nulla est ullamco ut irure incididunt nulla Lorem Lorem minim irure officia enim
                            reprehenderit.
                            Magna duis labore cillum sint adipisicing exercitation ipsum. Nostrud ut anim non
                            exercitation velit laboris fugiat cupidatat.
                            Commodo esse dolore fugiat sint velit ullamco magna consequat voluptate minim amet aliquip
                            ipsum aute laboris nisi.
                            Labore labore veniam irure irure ipsum pariatur mollit magna in cupidatat dolore magna irure
                            esse tempor ad mollit.
                            Dolore commodo nulla minim amet ipsum officia consectetur amet ullamco voluptate nisi
                            commodo ea sit eu.
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_9" role="tabpanel">
                            Sint sit mollit irure quis est nostrud cillum consequat Lorem esse do quis dolor esse fugiat
                            sunt do.
                            Eu ex commodo veniam Lorem aliquip laborum occaecat qui Lorem esse mollit dolore anim
                            cupidatat.
                            eserunt officia id Lorem nostrud aute id commodo elit eiusmod enim irure amet eiusmod qui
                            reprehenderit nostrud tempor.
                            Fugiat ipsum excepteur in aliqua non et quis aliquip ad irure in labore cillum elit enim.
                            Consequat aliquip incididunt
                            ipsum et minim laborum laborum laborum et cillum labore. Deserunt adipisicing cillum id
                            nulla minim nostrud labore eiusmod et amet.
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_10" role="tabpanel">
                            Et et consectetur ipsum labore excepteur est proident excepteur ad velit occaecat qui minim
                            occaecat veniam.
                            Fugiat veniam incididunt anim aliqua enim pariatur veniam sunt est aute sit dolor anim.
                            Velit non irure adipisicing aliqua
                            ullamco irure incididunt irure non esse consectetur nostrud minim non minim occaecat. Amet
                            duis do nisi duis veniam non est eiusmod
                            tempor incididunt tempor dolor ipsum in qui sit.
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_11" role="tabpanel">
                            Nulla est ullamco ut irure incididunt nulla Lorem Lorem minim irure officia enim
                            reprehenderit.
                            Magna duis labore cillum sint adipisicing exercitation ipsum. Nostrud ut anim non
                            exercitation velit laboris fugiat cupidatat.
                            Commodo esse dolore fugiat sint velit ullamco magna consequat voluptate minim amet aliquip
                            ipsum aute laboris nisi.
                            Labore labore veniam irure irure ipsum pariatur mollit magna in cupidatat dolore magna irure
                            esse tempor ad mollit.
                            Dolore commodo nulla minim amet ipsum officia consectetur amet ullamco voluptate nisi
                            commodo ea sit eu.
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_12" role="tabpanel">
                            Sint sit mollit irure quis est nostrud cillum consequat Lorem esse do quis dolor esse fugiat
                            sunt do.
                            Eu ex commodo veniam Lorem aliquip laborum occaecat qui Lorem esse mollit dolore anim
                            cupidatat.
                            eserunt officia id Lorem nostrud aute id commodo elit eiusmod enim irure amet eiusmod qui
                            reprehenderit nostrud tempor.
                            Fugiat ipsum excepteur in aliqua non et quis aliquip ad irure in labore cillum elit enim.
                            Consequat aliquip incididunt
                            ipsum et minim laborum laborum laborum et cillum labore. Deserunt adipisicing cillum id
                            nulla minim nostrud labore eiusmod et amet.
                        </div>

                        <div class="tab-pane fade" id="kt_tab_pane_13" role="tabpanel">
                            Et et consectetur ipsum labore excepteur est proident excepteur ad velit occaecat qui minim
                            occaecat veniam.
                            Fugiat veniam incididunt anim aliqua enim pariatur veniam sunt est aute sit dolor anim.
                            Velit non irure adipisicing aliqua
                            ullamco irure incididunt irure non esse consectetur nostrud minim non minim occaecat. Amet
                            duis do nisi duis veniam non est eiusmod
                            tempor incididunt tempor dolor ipsum in qui sit.
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--end::Card body-->
    </div>
    @push('styles')
    <link href="https://cdn.datatables.net/responsive/2.5.0/css/responsive.dataTables.min.css" rel="stylesheet">
    @endpush

    @push('scripts')
    {{-- <script src="https://code.jquery.com/jquery-3.7.0.js"></script> --}}
    <script src="https://cdn.datatables.net/responsive/2.5.0/js/dataTables.responsive.min.js"></script>

    <script>
        $(document).ready(function() {
        // new DataTable('#company', {
        //     ajax: {
        //         url: '/setting/api/company',
        //         dataSrc: ''
        //     },
        //     responsive: true,
        //     processing: true,
        //     // serverSide: true,
        //     columns: [
        //         { data: 'cid' },
        //         { data: 'user_id' },
        //         { data: 'name' },
        //         { data: 'status' },
        //         { data: 'address' },
        //         { data: 'phone' },
        //         { data: 'email' },
        //         { data: 'website' },
        //         { data: 'logo' },
        //         { data: 'created_at' }
        //     ]
        // });

        var table = $('#companyTable').DataTable({
            ajax: {
                url: '/setting/api/company',
                dataSrc: ''
            },
            processing: true,
        columns: [
            {
                data: 'id',
                render: function (data, type, row) {
                    // Trim the address text to the first 25 characters
                    return data.length > 25 ? data.substr(0, 8) + '...' : data;
                }
            },
            { data: 'cid' },
            { data: 'user_id' },
            { data: 'name' },
            { data: 'status' },
            { data: 'address' },
            { data: 'phone' },
            { data: 'email' },
            { data: 'website' },
            { data: 'logo' },
            {
                data: 'created_at',
                render: function (data, type, row) {
                    if (type === 'display' || type === 'filter') {
                        // Format the date as "YYYY-MM-DD HH:MM:SS"
                        var date = new Date(data);
                        return date.toLocaleString();
                    }
                    return data; // For sorting and other types
                }
            }
        ]
    });

    // Double-click event on the "Status" column
    $('#companyTable').on('dblclick', 'td:nth-child(5)', function() {
        var cell = table.cell(this);
        var rowData = cell.data();
        var row = table.row($(this).parents('tr'));

        // Create a dropdown with status options
        var dropdown = '<select class="status-select">';
        dropdown += '<option value="">Choose</option>';
        dropdown += '<option value="Active">Active</option>';
        dropdown += '<option value="Pending">Pending</option>';
        dropdown += '<option value="Banned">Banned</option>';
        dropdown += '<option value="Suspend">Suspend</option>';
        dropdown += '<option value="Pending Review">Pending Review</option>';
        dropdown += '</select>';

        // Set the cell's content to the dropdown
        cell.data(dropdown).draw();

        // Listen for changes to the dropdown
        $('.status-select').on('change', function() {
            var updatedStatus = $(this).val();

            // Get the ID of the row
            var id = row.data().id;

            // Make an AJAX request to update the status
            $.ajax({
                url: '/setting/api/update-company-status/' + id, // Include the ID in the URL
                method: 'PUT', // Use the appropriate HTTP method (PUT or POST)
                data: {
                    _token: '{{ csrf_token() }}',
                    status: updatedStatus
                },
                success: function(response) {
                    // Update the cell with the new status
                    cell.data(updatedStatus).draw();
                    swal.fire({
                                text: response.message,
                                icon: "success",
                                buttonsStyling: false,
                                confirmButtonText: "Ok, got it!",
                                customClass: {
                                    confirmButton: "btn font-weight-bold btn-light-primary"
                                }
                            }).then(function(){
                                table.ajax.reload();
                            });

                },
                error: function(xhr) {
                    // Handle errors here
                    Swal.fire({
                        text: "Sorry, looks like there are some errors detected, please try again.",
                        icon: "error",
                        buttonsStyling: false,
                        confirmButtonText: "Ok, got it!",
                        customClass: {
                            confirmButton: "btn btn-primary"
                        }
                    });
                }
            });
        });

        // Listen for changes to the dropdown
        // $('.status-select').on('change', function() {
        //     var updatedStatus = $(this).val();

        //     // Make an AJAX request to update the status
        //     $.ajax({
        //         url: '/update-company-status', // Replace with your update status route
        //         method: 'POST',
        //         data: {
        //             _token: '{{ csrf_token() }}',
        //             id: rowData.id, // Replace with your unique identifier for the row
        //             status: updatedStatus
        //         },
        //         success: function(response) {
        //             // Update the cell with the new status
        //             cell.data(updatedStatus).draw();
        //         },
        //         error: function(xhr) {
        //             // Handle errors here
        //         }
        //     });
        // });
    });
    });

    </script>
    @endpush

</x-default-layout>
